<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Construis ton systÃ¨me â€” SchÃ©ma-bloc</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <div id="app">
      <header class="topbar">
        <div class="brand" id="btn-home-title" role="button" tabindex="0" aria-label="Retour Ã  lâ€™accueil">ðŸ”§ Construis ton systÃ¨me</div>
        <div class="titlebar">
          <input id="board-title" type="text" placeholder="Titre du schÃ©ma" aria-label="Titre du schÃ©ma" />
        </div>
        <div class="top-actions">
          <button id="btn-help" class="secondary">Consignes</button>
          <span id="room-indicator"></span>
        </div>
      </header>

      <main id="view-home" class="view">
        <section class="card">
          <h2>Nouvelle session</h2>
          <label>Nom de lâ€™Ã©quipe
            <input type="text" id="team-name" placeholder="Ex: Les Ã‰lectronauts" />
          </label>
          <div class="actions">
            <button id="btn-solo">Solo (Casseâ€‘tÃªte)</button>
            <button id="btn-sandbox" class="secondary">Sandbox</button>
          </div>
        </section>
        <section class="card">
          <h2>Rejoindre une salle</h2>
          <label>Code de salle
            <input type="text" id="join-code" placeholder="ABC123" />
          </label>
          <div class="actions">
            <button id="btn-join">Rejoindre</button>
            <button id="btn-create">CrÃ©er une salle</button>
          </div>
        </section>
      </main>

      <main id="view-board" class="view hidden">
        <section class="sidebar">
          <div class="panel" id="puzzle-panel">
            <h3>Casseâ€‘tÃªte</h3>
            <label>Choisir
              <select id="puzzle-select">
                <option value="">â€” Aucun â€”</option>
              </select>
            </label>
            <div id="puzzle-details" class="puzzle-details hidden"></div>
            <div class="actions">
              <button id="btn-add-empty-block" class="secondary" aria-label="Ajouter un bloc vide">Ajouter un bloc vide</button>
            </div>
            <div class="hint">SÃ©lectionne un casseâ€‘tÃªte puis clique sur les cartes suggÃ©rÃ©es pour les ajouter, ou utilise les actions ciâ€‘dessus.</div>
          </div>
          <div class="panel" id="draw-panel">
            <h3>Pioche de cartes</h3>
            <div class="draw-controls">
              <label>Cartes
                <input type="number" id="draw-count" min="3" max="12" value="4" style="width:64px" />
              </label>
              <label>SÃ©quences
                <select id="draw-sequences">
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="5">5</option>
                  <option value="10">10</option>
                  <option value="20">20</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                </select>
              </label>
            </div>
            <button id="btn-draw" aria-label="Piger des cartes">Piger</button>
            <div id="drawn-cards" class="cards"></div>
            <div id="draw-proposals" class="cards"></div>
            <div class="alea">
              <strong>ProblÃ©matique:</strong>
              <span id="alea-display">â€“</span>
            </div>
          </div>
          <!-- Section Ã‰quipe retirÃ©e en mode casseâ€‘tÃªte -->
          <!-- Titre dÃ©placÃ© dans la barre du haut -->
          <!-- Section Outils retirÃ©e en mode casseâ€‘tÃªte (flÃ¨ches via poignÃ©es) -->
          <div class="panel" id="score-panel">
            <h3>Score & Progression</h3>
            <div class="score-row"><span>Score:</span> <strong id="score-value">0</strong></div>
            <div class="progress"><div id="progress-bar"></div></div>
            <div id="score-hint" class="hint">Gagne des points avec des blocs reliÃ©s, les deux types de flÃ¨ches et une rÃ©ponse dÃ©taillÃ©e.</div>
          </div>
          <div class="panel">
            <h3>Exporter / Sauvegarder</h3>
            <button id="btn-export-png" aria-label="Exporter en PNG">Exporter PNG</button>
            <button id="btn-export-pdf" aria-label="Exporter en PDF">Exporter PDF</button>
            <button id="btn-save" class="secondary" aria-label="Sauvegarder">Sauvegarder</button>
            <button id="btn-load" class="secondary" aria-label="Recharger">Recharger</button>
          </div>
        </section>

        <section class="board-wrap">
          <div id="board" class="board"></div>
          <div id="legend" class="legend" aria-label="LÃ©gende des flÃ¨ches">
            <div class="leg-row"><span class="leg-line energy"></span><span class="leg-label">Ã‰nergie</span></div>
            <div class="leg-row"><span class="leg-line signal"></span><span class="leg-label">Communication</span></div>
            <div class="leg-row"><span class="leg-line control"></span><span class="leg-label">ContrÃ´le</span></div>
          </div>
        </section>
      </main>
    </div>

    <div id="help-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Consignes de l'activitÃ©">
      <div class="content">
        <div class="close-row"><button id="btn-help-close">Fermer</button></div>
        <h2>ActivitÃ© â€” Construis ton systÃ¨me</h2>
        <ol>
          <li>Pige 4 cartes Â« Ã©lÃ©ments Â» et 1 Â« problÃ©matique Â».</li>
          <li>DÃ©pose les Ã©lÃ©ments sur le tableau et organise-les.</li>
          <li>Relie les blocs avec des flÃ¨chesÂ :
            Ã‰nergie (rouge, Ã©pais) et Signal (bleu, fin).</li>
          <li>Doubleâ€‘clic sur un bloc ou un lien pour ajouter un texte (ex.: 12Â V, Wiâ€‘Fi).</li>
          <li>Indique comment votre systÃ¨me rÃ©pond Ã  la problÃ©matique.</li>
          <li>Exportez votre schÃ©ma en PNG ou en PDF.</li>
        </ol>
        <p>Astuce: active/dÃ©sactive la grille magnÃ©tique selon tes besoins.</p>
        <p>Raccourcis: E pour flÃ¨che Ã‰nergie, S pour flÃ¨che Signal.</p>
      </div>
    </div>

    <script src="/app.js"></script>
  </body>
  </html>
